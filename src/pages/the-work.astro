---
import Layout from '../layouts/Layout.astro';
import { getCollection } from 'astro:content';
import ContentPreviewMasonry from '../components/ContentPreviewMasonry.astro';
import Values from '../components/Values.astro';
const portfolioCollection = await getCollection('portfolio');
const pages = portfolioCollection.map((item) => ({
  title: item.data.title,
  path: `/the-work/${item.data.slug}`,
}));

const currentPath = getCurrentPath();

function getCurrentPath() {
  const pathname = new URL(Astro.request.url).pathname;
  const currentPath = pathname.slice(1); // remove the first "/
  return currentPath;
}
---

<Layout title='The Work' subPages={pages}>
  <!-- TODO: add Values to Layout component; allow for an intro slot for the index page. -->
  <Values />

  <ContentPreviewMasonry basePath={currentPath} collection={portfolioCollection} />
</Layout>

---
import { getEntry, getCollection } from 'astro:content';
import Layout from '../../layouts/Layout.astro';
import PostPageLayout from '../../layouts/PostPageLayout.astro';
import { Picture } from 'astro:assets';
import Values from '../../components/Values.astro';
const { slug } = Astro.params;
if (slug === undefined) {
  throw new Error('Slug is required');
}
const entry = await getEntry('portfolio', slug);
if (entry === undefined) {
  return Astro.redirect('/404');
}
const { Content } = await entry.render();

const portfolioCollection = await getCollection('portfolio');
const pages = portfolioCollection.map((item) => ({
  title: item.data.title,
  path: `/the-work/${item.slug}`,
}));
---

<Layout title={entry.data.title} subPages={pages}>
  <Values />

  <PostPageLayout>
    <Content slot='content' />
    <div class='images'>
      <div class='image-container'>
        <Picture src={entry.data.background} alt='' inferSize={false} />
      </div>
      <div class='body-image-container'>
        {
          entry.data.screenshot && (
            <Picture
              src={entry.data.screenshot.image}
              alt={entry.data.screenshot.altText}
              class='screenshot'
            />
          )
        }
      </div>
    </div>
  </PostPageLayout>
</Layout>

<style>
  .images {
    position: relative;
    overflow-y: auto;
  }

  .body-image-container {
    position: relative;

    picture img {
      max-width: 100%;
      height: 400px;
      object-fit: contain;
      object-position: top;
    }
  }

  .image-container {
    position: absolute;
    inset: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;

    picture,
    picture img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      object-position: center;
    }
  }
</style>
